apologies for the messy code
